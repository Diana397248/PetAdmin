import{d as x,p as T,m as N,Q as U,l as F,o as p,e as g,a as e,f as C,q as f,b as y,u as r,F as D,g as j,s as u,v as _,n as b,t as h,h as B}from"./app-8d0782cb.js";import{h as E}from"./moment-fbc5633a.js";import{r as M}from"./PlusIcon-d843c3af.js";import{r as S}from"./TrashIcon-5e570acf.js";const a=x({}),q=c=>{a.value={};for(let s=0;s<c.length;s++){const n=c[s];!n.vaccine_name||!n.vaccine_name.trim()?a.value[`vaccinations[${s}].vaccine_name`]="This field is required.":n.vaccine_name.length>255&&(a.value[`vaccinations[${s}].vaccine_name`]="This field must not exceed 255 characters."),n.administered_at?A(n.administered_at)||(a.value[`vaccinations[${s}].administered_at`]="This field must be a valid date."):a.value[`vaccinations[${s}].administered_at`]="This field is required.",n.batch_number&&n.batch_number.length>255&&(a.value[`vaccinations[${s}].batch_number`]="This field must not exceed 255 characters."),n.administering_veterinarian&&n.administering_veterinarian.length>255&&(a.value[`vaccinations[${s}].administering_veterinarian`]="This field must not exceed 255 characters."),n.notes&&typeof n.notes!="string"&&(a.value[`vaccinations[${s}].notes`]="This field must be a string.")}},Y=c=>{a.value[c]&&(a.value[c]="")},O=c=>{Object.keys(c).forEach(s=>{T(()=>c[s],()=>{Y(s)})})};function A(c){return/^\d{4}-\d{2}-\d{2}$/.test(c)}const I={class:"max-w-full bg-white rounded-md mt-2"},z={class:"text-lg font-semibold leading-6 text-gray-900 border-b p-6 flex justify-between items-center"},L=["onClick"],P=["onSubmit"],Q={class:"col-span-12 md:col-span-6 lg:col-span-2"},G=e("label",{for:"vaccine_name",class:"mb-2 block text-sm font-medium text-gray-500"},"Vaccine Name",-1),H=["onUpdate:modelValue"],J={class:"text-red-500 text-xs"},K={class:"col-span-12 md:col-span-6 lg:col-span-2"},R=e("label",{for:"administered_at",class:"mb-2 block text-sm font-medium text-gray-500"},"Date",-1),W=["onUpdate:modelValue"],X={class:"text-red-500 text-xs"},Z={class:"col-span-12 md:col-span-6 lg:col-span-2"},ee=e("label",{for:"batch_number",class:"mb-2 block text-sm font-medium text-gray-500"},"Batch Number",-1),ae=["onUpdate:modelValue"],te={class:"text-red-500 text-xs"},se={class:"col-span-12 md:col-span-6 lg:col-span-2"},ne=e("label",{for:"administering_veterinarian",class:"mb-2 block text-sm font-medium text-gray-500"},"Administering Veterinarian",-1),ie=["onUpdate:modelValue"],oe={class:"text-red-500 text-xs"},de={class:"col-span-12 md:col-span-6 lg:col-span-3"},re=e("label",{for:"notes",class:"mb-2 block text-sm font-medium text-gray-500"},"Notes",-1),ce=["onUpdate:modelValue"],le={class:"text-red-500 text-xs"},me={class:"col-span-12 sm:col-span-1 mt-7"},ue=["onClick"],_e={class:"col-span-12 m-5 pb-5"},be=["disabled"],fe={__name:"VaccinationsForm",props:{pet:{type:Object,required:!0}},setup(c){const s=x(!1),n=N(),{pet:v}=U().props;F(async()=>{await k(),O(o.value)});const o=x([{vaccine_name:"",administered_at:"",batch_number:"",administering_veterinarian:"",notes:""}]),w=()=>{o.value.push({pet_id:"",vaccine_name:"",administered_at:"",batch_number:"",administering_veterinarian:"",notes:""})},V=async l=>{const m=o.value[l].id;o.value.length===1?o.value[l]={vaccine_name:"",administered_at:"",batch_number:"",administering_veterinarian:"",notes:""}:o.value.splice(l,1),await axios.delete(`/pets/${v.id}/vaccinations/${m}`),n.success("Vaccination successfully deleted!")},$=async()=>{if(s.value=!0,q(o.value),Object.keys(a.value).length>0){n.error("Please correct the errors in the form."),s.value=!1;return}let l={vaccinations:o.value};l.vaccinations.forEach(t=>{t.pet_id=v.id,t.id||(t.id=null),t.administered_at?t.administered_at=E(t.administered_at).format("YYYY-MM-DD"):delete t.administered_at});const m=await axios.post(`/pets/${v.id}/vaccinations`,l,{headers:{"Content-Type":"application/json"}});n.success(m.data.message),a.value={},m.data.vaccinations&&m.data.vaccinations.length>0&&m.data.vaccinations.forEach(t=>{const i=o.value.findIndex(d=>d.id===null);i!==-1&&o.value.splice(i,1,t)}),s.value=!1},k=async()=>{const l=await axios.get(`/pets/${v.id}/vaccinations`);o.value=l.data,o.value.length===0&&o.value.push({vaccine_name:"",administered_at:"",batch_number:"",administering_veterinarian:"",notes:""})};return(l,m)=>(p(),g("div",I,[e("div",z,[C(" Vaccinations "),e("button",{onClick:f(w,["stop","prevent"]),class:"bg-indigo-500 hover:bg-indigo-700 text-white p-2 rounded-md"},[y(r(M),{class:"h-6 w-6"})],8,L)]),e("form",{onSubmit:f($,["prevent"]),class:"mt-6"},[(p(!0),g(D,null,j(o.value,(t,i)=>(p(),g("div",{key:i,class:"grid grid-cols-12 gap-5 mb-5 p-5"},[e("div",Q,[G,u(e("input",{"onUpdate:modelValue":d=>t.vaccine_name=d,name:"vaccine_name",id:"vaccine_name",placeholder:"Vaccine Name",class:b(["block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-700 disabled:cursor-not-allowed disabled:bg-gray-50 disabled:text-gray-500 placeholder:text-sm",{"border-red-500":r(a)[`vaccinations[${i}].vaccine_name`]}])},null,10,H),[[_,t.vaccine_name]]),e("span",J,h(r(a)[`vaccinations[${i}].vaccine_name`]),1)]),e("div",K,[R,u(e("input",{type:"date","onUpdate:modelValue":d=>t.administered_at=d,class:b(["block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-700 disabled:cursor-not-allowed disabled:bg-gray-50 disabled:text-gray-500 placeholder:text-sm",{"border-red-500":r(a)[`vaccinations[${i}].administered_at`]}])},null,10,W),[[_,t.administered_at]]),e("span",X,h(r(a)[`vaccinations[${i}].administered_at`]),1)]),e("div",Z,[ee,u(e("input",{"onUpdate:modelValue":d=>t.batch_number=d,name:"batch_number",id:"batch_number",placeholder:"Batch Number",class:b(["block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-700 disabled:cursor-not-allowed disabled:bg-gray-50 disabled:text-gray-500 placeholder:text-sm",{"border-red-500":r(a)[`vaccinations[${i}].batch_number`]}])},null,10,ae),[[_,t.batch_number]]),e("span",te,h(r(a)[`vaccinations[${i}].batch_number`]),1)]),e("div",se,[ne,u(e("input",{"onUpdate:modelValue":d=>t.administering_veterinarian=d,name:"administering_veterinarian",id:"administering_veterinarian",placeholder:"Administering Veterinarian",class:b(["block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-700 disabled:cursor-not-allowed disabled:bg-gray-50 disabled:text-gray-500 placeholder:text-sm",{"border-red-500":r(a)[`vaccinations[${i}].administering_veterinarian`]}])},null,10,ie),[[_,t.administering_veterinarian]]),e("span",oe,h(r(a)[`vaccinations[${i}].administering_veterinarian`]),1)]),e("div",de,[re,u(e("textarea",{"onUpdate:modelValue":d=>t.notes=d,name:"notes",id:"notes",placeholder:"Notes",rows:"5",class:b(["block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-700 disabled:cursor-not-allowed disabled:bg-gray-50 disabled:text-gray-500 placeholder:text-sm",{"border-red-500":r(a)[`vaccinations[${i}].notes`]}])},null,10,ce),[[_,t.notes]]),e("span",le,h(r(a)[`vaccinations[${i}].notes`]),1)]),e("div",me,[t.id?(p(),g("button",{key:0,onClick:f(d=>V(i),["stop","prevent"]),class:"text-red-500 hover:text-red-700 p-2 rounded-md"},[y(r(S),{class:"h-6 w-6"})],8,ue)):B("",!0)])]))),128)),e("div",_e,[e("button",{type:"submit",disabled:s.value,class:"w-full rounded-lg border border-indigo-700 bg-indigo-700 px-8 py-4 text-center text-lg font-medium text-white shadow-sm transition-all hover:border-indigo-800 hover:bg-indigo-800 disabled:cursor-not-allowed disabled:border-indigo-300 disabled:bg-indigo-300"}," Save Vaccinations ",8,be)])],40,P)]))}};export{fe as default};
