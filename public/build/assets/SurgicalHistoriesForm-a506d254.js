import{d as x,p as V,m as T,Q as F,l as N,o as g,e as p,a as e,f as U,q as v,b as w,u as c,F as C,g as D,s as b,v as _,n as h,t as f,h as j}from"./app-8d0782cb.js";import{h as E}from"./moment-fbc5633a.js";import{r as H}from"./PlusIcon-d843c3af.js";import{r as M}from"./TrashIcon-5e570acf.js";const t=x({}),q=l=>{t.value={};for(let o=0;o<l.length;o++){const r=l[o];!r.procedure_name||!r.procedure_name.trim()?t.value[`surgeries[${o}].procedure_name`]="This field is required.":r.procedure_name.length>255&&(t.value[`surgeries[${o}].procedure_name`]="This field must not exceed 255 characters."),r.date?O(r.date)||(t.value[`surgeries[${o}].date`]="This field must be a valid date."):t.value[`surgeries[${o}].date`]="This field is required.",r.surgeon&&r.surgeon.length>255&&(t.value[`surgeries[${o}].surgeon`]="This field must not exceed 255 characters."),r.notes&&typeof r.notes!="string"&&(t.value[`surgeries[${o}].notes`]="This field must be a string.")}},Y=l=>{t.value[l]&&(t.value[l]="")},B=l=>{Object.keys(l).forEach(o=>{V(()=>l[o],()=>{Y(o)})})};function O(l){return/^\d{4}-\d{2}-\d{2}$/.test(l)}const P={class:"max-w-full bg-white rounded-md mt-2"},I={class:"text-lg font-semibold leading-6 text-gray-900 border-b p-6 flex justify-between items-center"},z=["onClick"],L=["onSubmit"],Q={class:"col-span-12 md:col-span-6 lg:col-span-2"},A=e("label",{for:"procedure_name",class:"mb-2 block text-sm font-medium text-gray-500"},"Procedure Name",-1),G=["onUpdate:modelValue"],J={class:"text-red-500 text-xs"},K={class:"col-span-12 md:col-span-6 lg:col-span-2"},R=e("label",{for:"date",class:"mb-2 block text-sm font-medium text-gray-500"},"Date",-1),W=["onUpdate:modelValue"],X={class:"text-red-500 text-xs"},Z={class:"col-span-12 md:col-span-6 lg:col-span-2"},ee=e("label",{for:"treatment",class:"mb-2 block text-sm font-medium text-gray-500"},"Surgeon",-1),se=["onUpdate:modelValue"],te={class:"text-red-500 text-xs"},oe={class:"col-span-12 md:col-span-6 lg:col-span-5"},ae=e("label",{for:"notes",class:"mb-2 block text-sm font-medium text-gray-500"},"Notes",-1),re=["onUpdate:modelValue"],de={class:"text-red-500 text-xs"},le={class:"col-span-12 sm:col-span-1 mt-7"},ne=["onClick"],ie={class:"col-span-12 m-5 pb-5"},ce=["disabled"],be={__name:"SurgicalHistoriesForm",props:{pet:{type:Object,required:!0}},setup(l){const o=x(!1),r=T(),{pet:m}=F().props;N(async()=>{await S(),B(a.value)});const a=x([{procedure_name:"",date:"",surgeon:"",notes:""}]),y=()=>{a.value.push({pet_id:"",procedure_name:"",date:"",surgeon:"",notes:""})},$=async n=>{if(a.value.length===1){const u=a.value[n].id;a.value[n]={procedure_name:"",date:"",surgeon:"",notes:""},await axios.delete(`/pets/${m.id}/surgeries/${u}`),r.success("Surgical History successfully deleted!")}else{const u=a.value[n];await axios.delete(`/pets/${m.id}/surgeries/${u.id}`),a.value.splice(n,1),r.success("Surgical History successfully deleted!")}},k=async()=>{if(o.value=!0,q(a.value),Object.keys(t.value).length>0){r.error("Please correct the errors in the form."),o.value=!1;return}let n={surgeries:a.value};n.surgeries.forEach(s=>{s.pet_id=m.id,s.id||(s.id=null),s.date?s.date=E(s.date).format("YYYY-MM-DD"):delete s.date});const u=await axios.post(`/pets/${m.id}/surgeries`,n,{headers:{"Content-Type":"application/json"}});r.success(u.data.message),t.value={},u.data.surgeries&&u.data.surgeries.length>0&&u.data.surgeries.forEach(s=>{const d=a.value.findIndex(i=>i.id===null);d!==-1&&a.value.splice(d,1,s)}),o.value=!1},S=async()=>{const n=await axios.get(`/pets/${m.id}/surgeries`);a.value=n.data,a.value.length===0&&a.value.push({procedure_name:"",date:"",surgeon:"",notes:""})};return(n,u)=>(g(),p("div",P,[e("div",I,[U(" Surgical History "),e("button",{onClick:v(y,["stop","prevent"]),class:"bg-indigo-500 hover:bg-indigo-700 text-white p-2 rounded-md"},[w(c(H),{class:"h-6 w-6"})],8,z)]),e("form",{onSubmit:v(k,["prevent"]),class:"mt-6"},[(g(!0),p(C,null,D(a.value,(s,d)=>(g(),p("div",{key:d,class:"grid grid-cols-12 gap-5 mb-5 p-5"},[e("div",Q,[A,b(e("input",{"onUpdate:modelValue":i=>s.procedure_name=i,name:"procedure_name",id:"procedure_name",placeholder:"Procedure Name",class:h(["block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-700 disabled:cursor-not-allowed disabled:bg-gray-50 disabled:text-gray-500 placeholder:text-sm",{"border-red-500":c(t)[`surgeries[${d}].procedure_name`]}])},null,10,G),[[_,s.procedure_name]]),e("span",J,f(c(t)[`surgeries[${d}].procedure_name`]),1)]),e("div",K,[R,b(e("input",{type:"date","onUpdate:modelValue":i=>s.date=i,class:h(["block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-700 disabled:cursor-not-allowed disabled:bg-gray-50 disabled:text-gray-500 placeholder:text-sm",{"border-red-500":c(t)[`surgeries[${d}].date`]}])},null,10,W),[[_,s.date]]),e("span",X,f(c(t)[`surgeries[${d}].date`]),1)]),e("div",Z,[ee,b(e("input",{"onUpdate:modelValue":i=>s.surgeon=i,name:"surgeon",id:"surgeon",placeholder:"Surgeon",class:h(["block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-700 disabled:cursor-not-allowed disabled:bg-gray-50 disabled:text-gray-500 placeholder:text-sm",{"border-red-500":c(t)[`surgeries[${d}].surgeon`]}])},null,10,se),[[_,s.surgeon]]),e("span",te,f(c(t)[`surgeries[${d}].surgeon`]),1)]),e("div",oe,[ae,b(e("textarea",{"onUpdate:modelValue":i=>s.notes=i,name:"notes",id:"notes",placeholder:"Notes",rows:"5",class:h(["block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-700 disabled:cursor-not-allowed disabled:bg-gray-50 disabled:text-gray-500 placeholder:text-sm",{"border-red-500":c(t)[`surgeries[${d}].notes`]}])},`
					`,10,re),[[_,s.notes]]),e("span",de,f(c(t)[`surgeries[${d}].notes`]),1)]),e("div",le,[s.id?(g(),p("button",{key:0,onClick:v(i=>$(d),["stop","prevent"]),class:"bg-red-500 hover:bg-red-700 text-white p-2 rounded-md"},[w(c(M),{class:"h-6 w-6"})],8,ne)):j("",!0)])]))),128)),e("div",ie,[e("button",{type:"submit",disabled:o.value,class:"w-full rounded-lg border border-indigo-700 bg-indigo-700 px-8 py-4 text-center text-lg font-medium text-white shadow-sm transition-all hover:border-indigo-800 hover:bg-indigo-800 disabled:cursor-not-allowed disabled:border-indigo-300 disabled:bg-indigo-300"}," Save ",8,ce)])],40,L)]))}};export{be as default};
