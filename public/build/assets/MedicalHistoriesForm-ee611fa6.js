import{d as w,p as M,m as H,Q as C,l as F,o as p,e as h,a as e,f as D,q as x,b as y,u as c,F as S,g as U,s as _,v as g,n as b,t as f,h as I,x as N,y as j}from"./app-8d0782cb.js";import{h as E}from"./moment-fbc5633a.js";import{_ as q}from"./_plugin-vue_export-helper-c27b6911.js";import{r as Y}from"./PlusIcon-d843c3af.js";import{r as B}from"./TrashIcon-5e570acf.js";const s=w({}),O=a=>{s.value={};for(let o=0;o<a.length;o++){const d=a[o];!d.condition||!d.condition.trim()?s.value[`histories[${o}].condition`]="This field is required.":d.condition.length>255&&(s.value[`histories[${o}].condition`]="This field must not exceed 255 characters."),d.diagnosis_date?P(d.diagnosis_date)||(s.value[`histories[${o}].diagnosis_date`]="This field must be a valid date."):s.value[`histories[${o}].diagnosis_date`]="This field is required.",d.treatment&&d.treatment.length>255&&(s.value[`histories[${o}].treatment`]="This field must not exceed 255 characters."),d.notes&&typeof d.notes!="string"&&(s.value[`histories[${o}].notes`]="This field must be a string.")}},z=a=>{s.value[a]&&(s.value[a]="")},L=a=>{Object.keys(a).forEach(o=>{M(()=>a[o],()=>{z(o)})})};function P(a){return/^\d{4}-\d{2}-\d{2}$/.test(a)}const v=a=>(N("data-v-68bf8c6a"),a=a(),j(),a),Q={class:"max-w-full bg-white rounded-md mt-2"},A={class:"text-lg font-semibold leading-6 text-gray-900 border-b p-6 flex justify-between items-center"},G=["onClick"],J=["onSubmit"],K={class:"col-span-12 md:col-span-6 lg:col-span-2"},R=v(()=>e("label",{for:"vaccine_name",class:"mb-2 block text-sm font-medium text-gray-500"},"Condition",-1)),W=["onUpdate:modelValue"],X={class:"text-red-500 text-xs"},Z={class:"col-span-12 md:col-span-6 lg:col-span-2"},ee=v(()=>e("label",{for:"diagnosis_date",class:"mb-2 block text-sm font-medium text-gray-500"},"Diagnosis Date",-1)),te=["onUpdate:modelValue"],se={class:"text-red-500 text-xs"},oe={class:"col-span-12 md:col-span-6 lg:col-span-2"},ae=v(()=>e("label",{for:"treatment",class:"mb-2 block text-sm font-medium text-gray-500"},"Treatment",-1)),ie=["onUpdate:modelValue"],de={class:"text-red-500 text-xs"},ne={class:"col-span-12 md:col-span-6 lg:col-span-5"},le=v(()=>e("label",{for:"notes",class:"mb-2 block text-sm font-medium text-gray-500"},"Notes",-1)),re=["onUpdate:modelValue"],ce={class:"text-red-500 text-xs"},ue={class:"col-span-12 sm:col-span-1 mt-7"},me=["onClick"],pe={class:"col-span-12 m-5 pb-5"},he=["disabled"],_e={__name:"MedicalHistoriesForm",props:{pet:{type:Object,required:!0}},setup(a){const o=w(!1),d=H(),{pet:m}=C().props;F(async()=>{await T(),L(i.value)});const i=w([{condition:"",diagnosis_date:"",treatment:"",notes:""}]),$=()=>{i.value.push({pet_id:"",condition:"",diagnosis_date:"",treatment:"",notes:""})},k=async l=>{if(i.value.length===1){const u=i.value[l].id;i.value[l]={condition:"",diagnosis_date:"",treatment:"",notes:""},await axios.delete(`/pets/${m.id}/histories/${u}`),d.success("Medical History successfully deleted!")}else{const u=i.value[l];await axios.delete(`/pets/${m.id}/histories/${u.id}`),i.value.splice(l,1),d.success("Medical History successfully deleted!")}},V=async()=>{if(o.value=!0,O(i.value),Object.keys(s.value).length>0){d.error("Please correct the errors in the form."),o.value=!1;return}let l={histories:i.value};l.histories.forEach(t=>{t.pet_id=m.id,t.id||(t.id=null),t.diagnosis_date?t.diagnosis_date=E(t.diagnosis_date).format("YYYY-MM-DD"):delete t.diagnosis_date});const u=await axios.post(`/pets/${m.id}/histories`,l,{headers:{"Content-Type":"application/json"}});d.success(u.data.message),s.value={},u.data.histories&&u.data.histories.length>0&&u.data.histories.forEach(t=>{const n=i.value.findIndex(r=>r.id===null);n!==-1&&i.value.splice(n,1,t)}),o.value=!1},T=async()=>{const l=await axios.get(`/pets/${m.id}/histories`);i.value=l.data,i.value.length===0&&i.value.push({condition:"",diagnosis_date:"",treatment:"",notes:""})};return(l,u)=>(p(),h("div",Q,[e("div",A,[D(" Medical History "),e("button",{onClick:x($,["stop","prevent"]),class:"bg-indigo-500 hover:bg-indigo-700 text-white p-2 rounded-md"},[y(c(Y),{class:"h-6 w-6"})],8,G)]),e("form",{onSubmit:x(V,["prevent"]),class:"mt-6"},[(p(!0),h(S,null,U(i.value,(t,n)=>(p(),h("div",{key:n,class:"grid grid-cols-12 gap-5 mb-5 p-5"},[e("div",K,[R,_(e("input",{"onUpdate:modelValue":r=>t.condition=r,name:"condition",id:"condition",placeholder:"Condition",class:b(["block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-700 disabled:cursor-not-allowed disabled:bg-gray-50 disabled:text-gray-500 placeholder:text-sm",{"border-red-500":c(s)[`histories[${n}].condition`]}])},null,10,W),[[g,t.condition]]),e("span",X,f(c(s)[`histories[${n}].condition`]),1)]),e("div",Z,[ee,_(e("input",{type:"date","onUpdate:modelValue":r=>t.diagnosis_date=r,class:b(["block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-700 disabled:cursor-not-allowed disabled:bg-gray-50 disabled:text-gray-500 placeholder:text-sm",{"border-red-500":c(s)[`histories[${n}].diagnosis_date`]}])},null,10,te),[[g,t.diagnosis_date]]),e("span",se,f(c(s)[`histories[${n}].diagnosis_date`]),1)]),e("div",oe,[ae,_(e("input",{"onUpdate:modelValue":r=>t.treatment=r,name:"treatment",id:"treatment",placeholder:"Treatment",class:b(["block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-700 disabled:cursor-not-allowed disabled:bg-gray-50 disabled:text-gray-500 placeholder:text-sm",{"border-red-500":c(s)[`histories[${n}].treatment`]}])},null,10,ie),[[g,t.treatment]]),e("span",de,f(c(s)[`histories[${n}].treatment`]),1)]),e("div",ne,[le,_(e("textarea",{"onUpdate:modelValue":r=>t.notes=r,name:"notes",id:"notes",placeholder:"Notes",rows:"5",class:b(["block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-700 disabled:cursor-not-allowed disabled:bg-gray-50 disabled:text-gray-500 placeholder:text-sm",{"border-red-500":c(s)[`histories[${n}].notes`]}])},null,10,re),[[g,t.notes]]),e("span",ce,f(c(s)[`histories[${n}].notes`]),1)]),e("div",ue,[t.id?(p(),h("button",{key:0,onClick:x(r=>k(n),["stop","prevent"]),class:"bg-red-500 hover:bg-red-700 text-white p-2 rounded-md"},[y(c(B),{class:"h-6 w-6"})],8,me)):I("",!0)])]))),128)),e("div",pe,[e("button",{type:"submit",disabled:o.value,class:"w-full rounded-lg border border-indigo-700 bg-indigo-700 px-8 py-4 text-center text-lg font-medium text-white shadow-sm transition-all hover:border-indigo-800 hover:bg-indigo-800 disabled:cursor-not-allowed disabled:border-indigo-300 disabled:bg-indigo-300"}," Save ",8,he)])],40,J)]))}},we=q(_e,[["__scopeId","data-v-68bf8c6a"]]);export{we as default};
