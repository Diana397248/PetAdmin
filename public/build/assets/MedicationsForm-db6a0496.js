import{d as y,p as V,m as M,Q as T,l as U,o as h,e as f,a as e,f as D,q as v,b as x,u as r,F,g as N,s as u,v as _,n as g,t as b,h as C}from"./app-8d0782cb.js";import{h as j}from"./moment-fbc5633a.js";import{r as E}from"./PlusIcon-d843c3af.js";import{r as S}from"./TrashIcon-5e570acf.js";const t=y({}),Y=l=>{t.value={};for(let a=0;a<l.length;a++){const o=l[a];!o.medication_name||!o.medication_name.trim()?t.value[`medications[${a}].medication_name`]="This field is required.":o.medication_name.length>255&&(t.value[`medications[${a}].medication_name`]="This field must not exceed 255 characters."),o.administered_at?A(o.administered_at)||(t.value[`medications[${a}].administered_at`]="This field must be a valid date."):t.value[`medications[${a}].administered_at`]="This field is required.",o.dosage&&o.dosage.length>255&&(t.value[`medications[${a}].dosage`]="This field must not exceed 255 characters."),o.frequency&&o.frequency.length>255&&(t.value[`medications[${a}].frequency`]="This field must not exceed 255 characters."),o.administering_veterinarian&&o.administering_veterinarian.length>255&&(t.value[`medications[${a}].administering_veterinarian`]="This field must not exceed 255 characters."),o.notes&&typeof o.notes!="string"&&(t.value[`medications[${a}].notes`]="This field must be a string.")}},B=l=>{t.value[l]&&(t.value[l]="")},O=l=>{Object.keys(l).forEach(a=>{V(()=>l[a],()=>{B(a)})})};function A(l){return/^\d{4}-\d{2}-\d{2}$/.test(l)}const I={class:"max-w-full bg-white rounded-md mt-2"},z={class:"text-lg font-semibold leading-6 text-gray-900 border-b p-6 flex justify-between items-center"},L=["onClick"],P=["onSubmit"],Q={class:"col-span-12 md:col-span-6 lg:col-span-2"},G=e("label",{for:"vaccine_name",class:"mb-2 block text-sm font-medium text-gray-500"},"Medication Name",-1),H=["onUpdate:modelValue"],J={class:"text-red-500 text-xs"},K={class:"col-span-12 md:col-span-6 lg:col-span-2"},R=e("label",{for:"administered_at",class:"mb-2 block text-sm font-medium text-gray-500"},"Date",-1),W=["onUpdate:modelValue"],X={class:"text-red-500 text-xs"},Z={class:"col-span-12 md:col-span-6 lg:col-span-1"},ee=e("label",{for:"batch_number",class:"mb-2 block text-sm font-medium text-gray-500"},"Dosage",-1),te=["onUpdate:modelValue"],se={class:"text-red-500 text-xs"},ae={class:"col-span-12 md:col-span-6 lg:col-span-1"},oe=e("label",{for:"frequency",class:"mb-2 block text-sm font-medium text-gray-500"},"Frequency",-1),ie=["onUpdate:modelValue"],de={class:"text-red-500 text-xs"},ne={class:"col-span-12 md:col-span-6 lg:col-span-2"},re=e("label",{for:"administering_veterinarian",class:"mb-2 block text-sm font-medium text-gray-500"},"Administering Veterinarian",-1),le=["onUpdate:modelValue"],ce={class:"text-red-500 text-xs"},me={class:"col-span-12 md:col-span-6 lg:col-span-3"},ue=e("label",{for:"notes",class:"mb-2 block text-sm font-medium text-gray-500"},"Notes",-1),_e=["onUpdate:modelValue"],ge={class:"text-red-500 text-xs"},be={class:"col-span-12 sm:col-span-1 mt-7"},pe=["onClick"],he={class:"col-span-12 m-5 pb-5"},fe=["disabled"],$e={__name:"MedicationsForm",props:{pet:{type:Object,required:!0}},setup(l){const a=y(!1),o=M(),{pet:p}=T().props;U(async()=>{await q(),O(d.value)});const d=y([{medication_name:"",administered_at:"",dosage:"",frequency:"",administering_veterinarian:"",notes:""}]),w=()=>{d.value.push({pet_id:"",medication_name:"",administered_at:"",dosage:"",frequency:"",administering_veterinarian:"",notes:""})},$=async c=>{if(d.value.length===1){const m=d.value[c].id;d.value[c]={medication_name:"",administered_at:null,dosage:"",frequency:"",administering_veterinarian:"",notes:""},await axios.delete(`/pets/${p.id}/medications/${m}`),o.success("Medication successfully deleted!")}else{const m=d.value[c];await axios.delete(`/pets/${p.id}/medications/${m.id}`),d.value.splice(c,1),o.success("Medication successfully deleted!")}},k=async()=>{if(a.value=!0,Y(d.value),Object.keys(t.value).length>0){o.error("Please correct the errors in the form."),a.value=!1;return}let c={medications:d.value};c.medications.forEach(s=>{s.pet_id=p.id,s.id||(s.id=null),s.administered_at?s.administered_at=j(s.administered_at).format("YYYY-MM-DD"):delete s.administered_at});const m=await axios.post(`/pets/${p.id}/medications`,c,{headers:{"Content-Type":"application/json"}});o.success(m.data.message),t.value={},m.data.medications&&m.data.medications.length>0&&m.data.medications.forEach(s=>{const i=d.value.findIndex(n=>n.id===null);i!==-1&&d.value.splice(i,1,s)}),a.value=!1},q=async()=>{const c=await axios.get(`/pets/${p.id}/medications`);d.value=c.data,d.value.length===0&&d.value.push({medication_name:"",administered_at:null,dosage:"",frequency:"",administering_veterinarian:"",notes:""})};return(c,m)=>(h(),f("div",I,[e("div",z,[D(" Medications "),e("button",{onClick:v(w,["stop","prevent"]),class:"bg-indigo-500 hover:bg-indigo-700 text-white p-2 rounded-md"},[x(r(E),{class:"h-6 w-6"})],8,L)]),e("form",{onSubmit:v(k,["prevent"]),class:"mt-6"},[(h(!0),f(F,null,N(d.value,(s,i)=>(h(),f("div",{key:i,class:"grid grid-cols-12 gap-5 mb-5 p-5"},[e("div",Q,[G,u(e("input",{"onUpdate:modelValue":n=>s.medication_name=n,name:"medication_name",id:"medication_name",placeholder:"Medication Name",class:g(["block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-700 disabled:cursor-not-allowed disabled:bg-gray-50 disabled:text-gray-500 placeholder:text-sm",{"border-red-500":r(t)[`medications[${i}].medication_name`]}])},null,10,H),[[_,s.medication_name]]),e("span",J,b(r(t)[`medications[${i}].medication_name`]),1)]),e("div",K,[R,u(e("input",{type:"date","onUpdate:modelValue":n=>s.administered_at=n,class:g(["block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-700 disabled:cursor-not-allowed disabled:bg-gray-50 disabled:text-gray-500 placeholder:text-sm",{"border-red-500":r(t)[`medications[${i}].administered_at`]}])},null,10,W),[[_,s.administered_at]]),e("span",X,b(r(t)[`medications[${i}].administered_at`]),1)]),e("div",Z,[ee,u(e("input",{"onUpdate:modelValue":n=>s.dosage=n,name:"dosage",id:"dosage",placeholder:"Dosage",class:g(["block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-700 disabled:cursor-not-allowed disabled:bg-gray-50 disabled:text-gray-500 placeholder:text-sm",{"border-red-500":r(t)[`medications[${i}].dosage`]}])},null,10,te),[[_,s.dosage]]),e("span",se,b(r(t)[`medications[${i}].dosage`]),1)]),e("div",ae,[oe,u(e("input",{"onUpdate:modelValue":n=>s.frequency=n,name:"frequency",id:"frequency",placeholder:"Frequency",class:g(["block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-700 disabled:cursor-not-allowed disabled:bg-gray-50 disabled:text-gray-500 placeholder:text-sm",{"border-red-500":r(t)[`medications[${i}].frequency`]}])},null,10,ie),[[_,s.frequency]]),e("span",de,b(r(t)[`medications[${i}].frequency`]),1)]),e("div",ne,[re,u(e("input",{"onUpdate:modelValue":n=>s.administering_veterinarian=n,name:"administering_veterinarian",id:"frequency",placeholder:"Administering Veterinarian",class:g(["block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-700 disabled:cursor-not-allowed disabled:bg-gray-50 disabled:text-gray-500 placeholder:text-sm",{"border-red-500":r(t)[`medications[${i}].administering_veterinarian`]}])},null,10,le),[[_,s.administering_veterinarian]]),e("span",ce,b(r(t)[`medications[${i}].administering_veterinarian`]),1)]),e("div",me,[ue,u(e("textarea",{"onUpdate:modelValue":n=>s.notes=n,name:"notes",id:"notes",placeholder:"Notes",rows:"5",class:g(["block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-700 disabled:cursor-not-allowed disabled:bg-gray-50 disabled:text-gray-500 placeholder:text-sm",{"border-red-500":r(t)[`medications[${i}].notes`]}])},null,10,_e),[[_,s.notes]]),e("span",ge,b(r(t)[`medications[${i}].notes`]),1)]),e("div",be,[s.id?(h(),f("button",{key:0,onClick:v(n=>$(i),["stop","prevent"]),class:"bg-red-500 hover:bg-red-700 text-white p-2 rounded-md"},[x(r(S),{class:"h-6 w-6"})],8,pe)):C("",!0)])]))),128)),e("div",he,[e("button",{type:"submit",disabled:a.value,class:"w-full rounded-lg border border-indigo-700 bg-indigo-700 px-8 py-4 text-center text-lg font-medium text-white shadow-sm transition-all hover:border-indigo-800 hover:bg-indigo-800 disabled:cursor-not-allowed disabled:border-indigo-300 disabled:bg-indigo-300"}," Save Medications ",8,fe)])],40,P)]))}};export{$e as default};
